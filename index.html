<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>PDF</title>

<!-- LIB -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
<script src="https://unpkg.com/mammoth/mammoth.browser.min.js"></script>

<style>
*{box-sizing:border-box;font-family:system-ui}
body{
  margin:0;min-height:100vh;
  background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
  color:#fff;padding:12px
}
.app{
  max-width:1100px;margin:auto;
  background:rgba(255,255,255,.12);
  backdrop-filter:blur(14px);
  border-radius:22px;padding:20px
}
.logo{display:flex;justify-content:center;margin-bottom:12px}
.logo img{height:70px;border-radius:18px}
.tabs{display:flex;gap:10px;justify-content:center;flex-wrap:wrap}
.tabs button{
  padding:10px 18px;border-radius:20px;border:none;
  background:rgba(255,255,255,.2);color:#fff;
  font-weight:600;cursor:pointer
}
.tabs button.active{
  background:linear-gradient(135deg,#00c6ff,#0072ff)
}
.panel{display:none;margin-top:18px}
.panel.active{display:block}
.upload{
  border:2px dashed rgba(255,255,255,.35);
  padding:26px;text-align:center;
  border-radius:16px;cursor:pointer
}
.upload input{display:none}
.grid{
  margin-top:20px;
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(150px,1fr));
  gap:14px
}
.file{
  position:relative;
  background:rgba(0,0,0,.35);
  border-radius:12px;padding:10px
}
.file img{
  width:100%;height:120px;
  object-fit:cover;border-radius:8px
}
.file-name{
  margin-top:6px;font-size:13px;
  text-align:center;word-break:break-all
}
.menu{
  position:absolute;inset:0;
  background:rgba(0,0,0,.65);
  display:none;align-items:center;
  justify-content:center;gap:10px;
  border-radius:12px
}
.file.active .menu{display:flex}
.menu button{
  border:none;padding:8px 12px;
  border-radius:8px;cursor:pointer
}
.actions{
  margin-top:18px;
  display:flex;gap:10px;
  justify-content:center;flex-wrap:wrap
}
.actions button{
  padding:12px 22px;
  border-radius:14px;border:none;
  background:linear-gradient(135deg,#00c6ff,#0072ff);
  color:#fff;font-weight:600;cursor:pointer
}
.reset{background:linear-gradient(135deg,#ff416c,#ff4b2b)}
.preview{
  position:fixed;inset:0;
  background:rgba(0,0,0,.85);
  display:none;align-items:center;
  justify-content:center;z-index:99
}
.preview img,.preview iframe{
  max-width:92%;max-height:92%;
  background:#fff
}
input.rename{
  width:100%;padding:6px;
  border-radius:6px;border:none;
  background:#111;color:#fff;
  text-align:center;font-size:14px
}
</style>
</head>

<body>
<div class="app">

<div class="logo">
<img src="https://lh3.googleusercontent.com/a/ACg8ocKmXTXh7YnKdycDCZXMBH_5D79UE14STXrbOZYS0It0WWTTTFf2=s288-c-no">
</div>

<div class="tabs">
<button class="active" onclick="switchTab(0)">·∫¢nh ‚ûú PDF</button>
<button onclick="switchTab(1)">PDF ‚ûú ·∫¢nh</button>
<button onclick="switchTab(2)">Word ‚ûú PDF</button>
</div>

<div class="panel active">
<label class="upload">
<input type="file" id="imgInput" accept="image/*" multiple>
üì∏ Ch·ªçn ·∫£nh
</label>
<div class="actions">
<button onclick="convertImg()">Chuy·ªÉn PDF A4</button>
<button onclick="download()">T·∫£i</button>
<button class="reset" onclick="resetAll()">Quay l·∫°i</button>
</div>
<div class="grid" id="grid"></div>
</div>

<div class="panel">
<label class="upload">
<input type="file" id="pdfInput" accept="application/pdf">
üìÑ Ch·ªçn PDF
</label>
<div class="actions">
<button onclick="convertPdf()">Chuy·ªÉn ·∫£nh</button>
<button onclick="download()">T·∫£i</button>
<button class="reset" onclick="resetAll()">Quay l·∫°i</button>
</div>
<div class="grid"></div>
</div>

<div class="panel">
<label class="upload">
<input type="file" id="wordInput" accept=".doc,.docx">
üìù Ch·ªçn Word
</label>
<div class="actions">
<button onclick="convertWord()">Chuy·ªÉn PDF</button>
<button onclick="download()">T·∫£i</button>
<button class="reset" onclick="resetAll()">Quay l·∫°i</button>
</div>
<div class="grid"></div>
</div>

</div>

<div class="preview" id="preview" onclick="this.style.display='none'"></div>

<script>
const { jsPDF } = window.jspdf;
let files=[];
const grid=document.getElementById("grid");

/* ===== MOBILE CHECK ===== */
function isMobile(){
  return /Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
}

/* ===== TAB ===== */
function switchTab(i){
document.querySelectorAll(".tabs button")
.forEach((b,x)=>b.classList.toggle("active",x===i));
document.querySelectorAll(".panel")
.forEach((p,x)=>p.classList.toggle("active",x===i));
resetAll();
}

/* ===== RESET ===== */
function resetAll(){
files=[];grid.innerHTML="";
imgInput.value=pdfInput.value=wordInput.value="";
}

/* ===== LOAD FILE ===== */
imgInput.onchange=()=>loadFiles(imgInput.files,"image");
pdfInput.onchange=()=>loadFiles(pdfInput.files,"pdf");
wordInput.onchange=()=>loadFiles(wordInput.files,"word");

function loadFiles(list,type){
files=[];
for(let f of list){
files.push({
name:f.name,
blob:f,
type,
url:type==="image"?URL.createObjectURL(f):null
});
}
render();
}

/* ===== RENDER ===== */
function render(){
grid.innerHTML="";
files.forEach((f,i)=>{
const div=document.createElement("div");
div.className="file";
div.innerHTML=`
${f.type==="image"
?`<img src="${f.url}">`
:`<img src="https://cdn-icons-png.flaticon.com/512/337/337946.png">`}
<div class="file-name"><span id="n${i}">${f.name}</span></div>
<div class="menu">
<button onclick="view(event,${i})">üëÅ</button>
<button onclick="rename(event,${i})">‚úèÔ∏è</button>
<button onclick="del(event,${i})">üóë</button>
</div>`;
div.onclick=()=>div.classList.toggle("active");
grid.appendChild(div);
});
}

/* ===== RENAME ===== */
function rename(e,i){
e.stopPropagation();
document.querySelectorAll(".file")[i].classList.remove("active");
const s=document.getElementById("n"+i);
const old=files[i].name;
s.outerHTML=`
<input class="rename" value="${old}"
onblur="save(${i},this.value)"
onkeydown="if(event.key==='Enter')this.blur()" autofocus>`;
}
function save(i,v){
if(v.trim()) files[i].name=v.trim();
render();
}

/* ===== DELETE ===== */
function del(e,i){
e.stopPropagation();
files.splice(i,1);
render();
}

/* ===== VIEW ===== */
function view(e,i){
e.stopPropagation();
preview.innerHTML=files[i].type==="image"
?`<img src="${files[i].url}">`
:`<iframe src="${URL.createObjectURL(files[i].blob)}"></iframe>`;
preview.style.display="flex";
}

/* ===== CONVERT ===== */
async function convertImg(){
const out=[];
for(const f of files){
const img=new Image();img.src=f.url;
await img.decode();
const pdf=new jsPDF({unit:"mm",format:"a4"});
const w=210,h=297;
const r=Math.min(w/img.width,h/img.height);
pdf.addImage(img,"JPEG",(w-img.width*r)/2,(h-img.height*r)/2,img.width*r,img.height*r);
out.push({name:f.name.replace(/\..+/,"")+".pdf",blob:pdf.output("blob")});
}
files=out;render();
}

async function convertPdf(){
const out=[];
for(const f of files){
const pdf=await pdfjsLib.getDocument(URL.createObjectURL(f.blob)).promise;
for(let i=1;i<=pdf.numPages;i++){
const page=await pdf.getPage(i);
const c=document.createElement("canvas");
const v=page.getViewport({scale:2});
c.width=v.width;c.height=v.height;
await page.render({canvasContext:c.getContext("2d"),viewport:v}).promise;
const b=await new Promise(r=>c.toBlob(r,"image/jpeg",1));
out.push({name:`${f.name}_page${i}.jpg`,blob:b,type:"image",url:URL.createObjectURL(b)});
}}
files=out;render();
}

async function convertWord(){
const f=files[0];
const ab=await f.blob.arrayBuffer();
const r=await mammoth.extractRawText({arrayBuffer:ab});
const pdf=new jsPDF();
pdf.text(r.value,10,10,{maxWidth:180});
files=[{name:f.name.replace(/\..+/,"")+".pdf",blob:pdf.output("blob")}];
render();
}

/* ===== DOWNLOAD ===== */
async function download(){
if(!files.length){alert("Kh√¥ng c√≥ file");return;}

/* MOBILE */
if(isMobile()){
if(files.length===1){
saveAs(files[0].blob,files[0].name);return;
}
for(const f of files){
await new Promise(r=>setTimeout(r,400));
saveAs(f.blob,f.name);
}
return;
}

/* DESKTOP */
if(files.length===1){
saveAs(files[0].blob,files[0].name);return;
}
const zip=new JSZip();
files.forEach(f=>zip.file(f.name,f.blob));
const blob=await zip.generateAsync({type:"blob"});
saveAs(blob,"files.zip");
}
</script>
</body>
</html>
